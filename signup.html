<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
    <script lang="./node_modules/md5/dist/md5.min.js"></script>
    <title>Sign up</title>
</head>
<body>
    <script>
        
        var db = openDatabase('mydb', '1.0', 'Test DB', 2 * 1024 * 1024); 

    
        db.transaction(function (tx) { 
            
            
     tx.executeSql('CREATE TABLE IF NOT EXISTS USERS (username varchar(255) NOT NULL,email varchar(255),password varchar(255) NOT NULL )');
     })
     
     function validateEmail(email) {
  const re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
  return re.test(email);
}
     function adduser(){
        
     db.transaction(function (tx) { 
    var username = document.getElementById("u1").value;
    var password = document.getElementById("p1").value;
    var password2=document.getElementById("p2").value;
    var email = document.getElementById("e1").value;
    
            tx.executeSql('SELECT * FROM USERS where username=? or email=?', [username,email], function (tx, results) { 
               

                if(results.rows.length>0)
                {
                    alert("username or email already have been used");
                }
                else{
    if(username==undefined || password2==undefined || password==undefined ){
     alert("feilds can't be empty");
    }
    else if(!validateEmail(email)){
     alert("email is not valid")
    }
    else if(password!=password2){
        alert("passwords doesn't match");
    }else{
        alert("user created succesfully");
        tx.executeSql('INSERT INTO USERS (username, email, password) VALUES (?,?,?)',[username,email,password]);
        window.location.replace("loginTest.html");
    
    }
                }
         }); 
          }); }
    
     
  
    </script>
    <div class="container">
        <strong>Username :</strong><br> 
    <input type="text" id="u1" class="form-control " placeholder="Username" aria-label="Username" aria-describedby="basic-addon1" required>
    <strong>E-mail :</strong><br>    
    <br>  <input type="email" id="e1" class="form-control " placeholder="E-mail" aria-label="Username" aria-describedby="basic-addon1" required>
    <strong>Password :</strong><br>
    <br> <input type="password" id="p1" class="form-control " placeholder="password" aria-label="password" aria-describedby="basic-addon1"required minlength="8">
    <strong>Confirm password :</strong><br>     
    <br> <input type="password" id="p2" class="form-control " placeholder="Repeat-password" aria-label="password" aria-describedby="basic-addon1" required minlength="8">
           
           <br> <button type="button" onclick="adduser()" class="btn btn-primary my-3">Sign up</button>
          
    </div>
</body>
</html>